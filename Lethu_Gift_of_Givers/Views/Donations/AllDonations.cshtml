@model IEnumerable<Lethu_Gift_of_Givers.Models.Donation>

@{
    ViewData["Title"] = "All Donations";
}

<div class="container mt-5">
    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-5">
        <div>
            <h2 class="fw-bold display-6 mb-2">
                <i class="fas fa-hand-holding-heart text-success me-3"></i>All Donations
            </h2>
            <p class="text-muted mb-0">Track and manage all donation activities</p>
        </div>
        <a asp-action="Create" class="btn btn-success btn-lg shadow-sm px-4 py-3">
            <i class="fas fa-plus me-2"></i> Make New Donation
        </a>
    </div>

    <!-- Stats Overview -->
    <div class="row mb-5">
        <div class="col-md-3 col-6">
            <div class="card border-0 rounded-3 shadow-sm bg-gradient-primary text-white h-100">
                <div class="card-body text-center p-4">
                    <i class="fas fa-boxes fa-2x mb-3"></i>
                    <h3 class="fw-bold mb-1">@Model.Count()</h3>
                    <p class="mb-0 small">Total Donations</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 col-6">
            <div class="card border-0 rounded-3 shadow-sm bg-gradient-success text-white h-100">
                <div class="card-body text-center p-4">
                    <i class="fas fa-calendar-check fa-2x mb-3"></i>
                    <h3 class="fw-bold mb-1">@Model.Count(d => d.DonationDate > DateTime.UtcNow.AddDays(-7))</h3>
                    <p class="mb-0 small">Last 7 Days</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 col-6">
            <div class="card border-0 rounded-3 shadow-sm bg-gradient-warning text-white h-100">
                <div class="card-body text-center p-4">
                    <i class="fas fa-clock fa-2x mb-3"></i>
                    <h3 class="fw-bold mb-1">@Model.Count(d => d.Status?.ToLower() == "pending")</h3>
                    <p class="mb-0 small">Pending</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 col-6">
            <div class="card border-0 rounded-3 shadow-sm bg-gradient-info text-white h-100">
                <div class="card-body text-center p-4">
                    <i class="fas fa-check-circle fa-2x mb-3"></i>
                    <h3 class="fw-bold mb-1">@Model.Count(d => d.Status?.ToLower() == "distributed")</h3>
                    <p class="mb-0 small">Distributed</p>
                </div>
            </div>
        </div>
    </div>

    @if (!Model.Any())
    {
        <!-- Empty State -->
        <div class="text-center py-5">
            <div class="profile-icon-lg bg-gradient-secondary mb-4">
                <i class="fas fa-hand-holding-heart fa-3x"></i>
            </div>
            <h3 class="fw-bold mb-3">No Donations Yet</h3>
            <p class="text-muted mb-4">Be the first to make a difference by creating a donation.</p>
            <a asp-action="Create" class="btn btn-primary btn-lg px-5">
                <i class="fas fa-plus me-2"></i> Make First Donation
            </a>
        </div>
    }
    else
    {
        <!-- Donations Grid -->
        <div class="row">
            @foreach (var donation in Model)
            {
                <div class="col-xl-4 col-lg-6 mb-4">
                    <div class="card h-100 shadow-sm border-0 rounded-3 feature-card">
                        <div class="card-header d-flex justify-content-between align-items-center border-bottom-0 bg-white pt-4">
                            <span class="badge px-3 py-2 fs-6 @GetDonationTypeBadgeClass(donation.DonationType)">
                                <i class="@GetDonationTypeIcon(donation.DonationType) me-2"></i>@donation.DonationType
                            </span>
                            <small class="text-muted fw-bold">
                                <i class="fas fa-calendar me-1"></i>@donation.DonationDate.ToString("MMM dd, yyyy")
                            </small>
                        </div>
                        <div class="card-body pb-3">
                            <h5 class="card-title fw-bold mb-3 text-dark">@donation.ItemDescription</h5>
                            <div class="donation-details">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-cube text-primary me-3"></i>
                                    <div>
                                        <small class="text-muted">Quantity</small>
                                        <div class="fw-bold">@donation.Quantity @donation.Unit</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-map-marker-alt text-danger me-3"></i>
                                    <div>
                                        <small class="text-muted">Target Area</small>
                                        <div class="fw-bold">@donation.TargetArea</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center mb-3">
                                    <i class="fas fa-user text-success me-3"></i>
                                    <div>
                                        <small class="text-muted">Donor</small>
                                        <div class="fw-bold">@donation.User?.FirstName @donation.User?.LastName</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer bg-white border-top-0 pt-0">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <span class="badge px-3 py-2 fs-6 @GetStatusBadgeClass(donation.Status)">
                                    @donation.Status
                                </span>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#"><i class="fas fa-eye me-2"></i>View Details</a></li>
                                        <li><a class="dropdown-item" href="#"><i class="fas fa-edit me-2"></i>Edit</a></li>
                                        <li><hr class="dropdown-divider"></li>
                                        <li><a class="dropdown-item text-danger" href="#"><i class="fas fa-trash me-2"></i>Delete</a></li>
                                    </ul>
                                </div>
                            </div>
                            @if (!string.IsNullOrEmpty(donation.SpecialInstructions))
                            {
                                <div class="alert alert-light border rounded-2 mb-0">
                                    <div class="d-flex">
                                        <i class="fas fa-info-circle text-info me-2 mt-1"></i>
                                        <small class="text-muted">@donation.SpecialInstructions</small>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>

        <!-- Summary Section -->
        <div class="mt-5 pt-4">
            <div class="card border-0 rounded-3 shadow-sm bg-gradient-dark text-white">
                <div class="card-body p-4">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="fw-bold mb-2"><i class="fas fa-chart-line me-2"></i>Donation Impact Summary</h4>
                            <p class="mb-0 opacity-75">
                                Your contributions are making a real difference in communities affected by disasters.
                            </p>
                        </div>
                        <div class="col-md-4 text-md-end">
                            <div class="mt-3 mt-md-0">
                                <div class="fw-bold fs-5">@Model.Count() Total Contributions</div>
                                <small class="opacity-75">@Model.Count(d => d.DonationDate > DateTime.UtcNow.AddDays(-7)) recent donations</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@functions {
    string GetDonationTypeBadgeClass(string type)
    {
        return type?.ToLower() switch
        {
            "food" => "bg-warning text-dark",
            "clothing" => "bg-info text-white",
            "medical" => "bg-danger text-white",
            "money" => "bg-success text-white",
            _ => "bg-secondary text-white"
        };
    }

    string GetDonationTypeIcon(string type)
    {
        return type?.ToLower() switch
        {
            "food" => "fas fa-utensils",
            "clothing" => "fas fa-tshirt",
            "medical" => "fas fa-first-aid",
            "money" => "fas fa-money-bill-wave",
            _ => "fas fa-gift"
        };
    }

    string GetStatusBadgeClass(string status)
    {
        return status?.ToLower() switch
        {
            "pending" => "bg-warning text-dark",
            "received" => "bg-info text-white",
            "distributed" => "bg-success text-white",
            "cancelled" => "bg-danger text-white",
            _ => "bg-secondary text-white"
        };
    }
}

<style>
    .bg-gradient-primary {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
    }

    .bg-gradient-success {
        background: linear-gradient(135deg, var(--success-color), #2ecc71) !important;
    }

    .bg-gradient-warning {
        background: linear-gradient(135deg, var(--warning-color), #f1c40f) !important;
    }

    .bg-gradient-info {
        background: linear-gradient(135deg, var(--secondary-color), #3498db) !important;
    }

    .bg-gradient-secondary {
        background: linear-gradient(135deg, #6c757d, #495057) !important;
    }

    .bg-gradient-dark {
        background: linear-gradient(135deg, var(--dark-color), #1c2b36) !important;
    }

    .donation-details {
        border-left: 3px solid var(--primary-color);
        padding-left: 1rem;
    }

    .feature-card {
        transition: var(--transition);
        border: none;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        overflow: hidden;
        border-top: 4px solid var(--accent-color);
    }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }

    .card-header {
        background: white !important;
        border-bottom: 1px solid #eee;
    }

    .badge {
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    .btn-success {
        background: linear-gradient(135deg, var(--success-color), #2ecc71);
        border: none;
        font-weight: 600;
    }

        .btn-success:hover {
            background: linear-gradient(135deg, #219653, var(--success-color));
            transform: translateY(-2px);
        }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        border: none;
        font-weight: 600;
    }

    .profile-icon-lg {
        width: 120px;
        height: 120px;
        background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1.5rem;
        color: white;
        box-shadow: var(--box-shadow);
    }
</style>